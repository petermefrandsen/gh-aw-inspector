# GH AW Inspector Architecture

The overarching goal is to provide a shell that can use any agentic / AI CLI under the hood, specifically focusing on parsing and simulating `gh aw` CLI commands in a sandboxed or mocked VS Code extension environment.

## AI Implementation Guidelines

The implementation of this extension should adhere to the following architecture:

1. **Extension Entry Point (`src/extension.ts`)**: 
   - Registers commands mapping to the GitHub Agentic Workflows CLI.
   - Sets up the `TreeDataProvider` for the Sidebar View.
   - Manages state using VS Code's `ExtensionContext.workspaceState` or `globalState`.

2. **Sidebar View (`src/providers/WorkflowTreeProvider.ts`)**: 
   - Uses `child_process.exec` to run `gh aw list`.
   - Parses the stdout to discover available `gh-aw` workflows.
   - Presents them hierarchically in the VS Code sidebar.

3. **Execution Simulator (`src/simulator/CommandRunner.ts`)**: 
   - Provides an interface (VS Code input boxes or a dedicated Webview) to input a "prompt" intended for a workflow.
   - Spawns child processes to run `gh aw run <workflow> --prompt "<input>"`.
   - Captures `stdout` and `stderr` robustly, preventing the UI from blocking.

4. **Markdown Generator (`src/generators/MarkdownBuilder.ts`)**: 
   - Takes the output from the CLI and pipes it through the evaluation prompt located at `src/prompts/evaluate-gh-aw.md`.
   - Formats the returned outputs into rich markdown files containing Description, Metadata, Prerequisites, Intent, and happy/unhappy paths.
   - Uses VS Code's `workspace.openTextDocument` to display the generated Markdown file to the user.

## Design Principles
- **Separation of Concerns**: Keep UI logic (TreeViews, Inputs) separate from CLI invocation logic (child_process wrappers).
- **Error Handling**: The CLI might fail or not be installed. The extension must gracefully handle `ENOENT` errors and prompt the user to install the `gh-aw` extension (`gh extension install github/gh-aw`).
- **Typings**: Ensure strong TypeScript typing for all CLI parsing interfaces.

## UI / UX Guidelines: The "Native Primer" Interface

To ensure a seamless experience within the GitHub ecosystem, the extension must strictly follow the **Primer Design System** conventions, making it feel like a native part of GitHub Copilot or the official Pull Request extension.

1. **Visual Language**:
   - Utilize clean, neutral grays provided by default VS Code theme tokens.
   - Respect standard VS Code system fonts.
   - If rendering custom HTML/Webviews, implement rounded buttons and inputs reflecting GitHub's native `.btn` styles.
   - Prioritize high legibility and familiarity above all else.

2. **Layout Structure**:
   - **Sidebar**: A dedicated VS Code Sidebar view containing the `gh-aw` CLI commands list, and the nested `gh aw list` of available agentic workflows.
   - **Simulation Split-View**: When triggering a "Simulation" (running a prompt against a workflow), the action should open in the main editor workspace area using a **split-view** arrangement:
     - *Left Pane*: An input mechanism (either a dedicated text document, input box, or webview) where the user drafts the Prompt.
     - *Right Pane*: The rendered Markdown report generated by the `MarkdownBuilder`, updated asynchronously.
